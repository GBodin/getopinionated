{% extends "base.html" %}
{% load filters %}
{% load macros %}
{% loadmacros "common/comma.html" %}
{% loadmacros "proposal/proposal-macro.html" %}
{% loadmacros "proposal/tag-macro.html" %}
{% load thumbnail %}
{% load humanize %}

{% block title %}{% include "title.html" with subtitle=member.display_name subtitle2="'s profile" %}{% endblock %}

{% block extrastyle %}
    <link rel="stylesheet" href="{{STATIC_URL}}css/profile.css" type="text/css" charset="utf-8" />
{% endblock %}

{% block content %}

	<h1>{{member.display_name}}</h1>
	<div class="gravatar">
		{% thumbnail member.avatar "128x128" crop="center" as im %}
			<div class="profile-picture">
		    	<img src="{{ im.url }}">
		    </div>
	    {% empty %}
		{% endthumbnail %}
		<div class="karma">
			<span>{{member.karma}}</span>
			karma
		</div>
	</div>
	<div class="data">
		<table>
			<tbody>
				<tr>
					<th>visits</th>
					<td>member for</td>
					<td>{{member.member_since|timesince}}</td>
				</tr>
				<tr>
					<th></th>
					<td>last login</td>
					<td>{{member.last_login|timesince}}</td>
				</tr>
			</tbody>
			<tbody>
				<tr>
					<th>Stats</th>
					<td>Profile views</td>
					<td>{{member.profile_views}}</td>
				</tr>
		</table>
	</div>
	
	{% block data %}
	    {% if proposal_list %}
	    	<div class="profile-proposal-list">
		    	<h1>{{member.display_name}}'s proposals</h1>
		        <ul>
		        {% for proposal in proposal_list %}
		        	<li>
		        		{% usemacro proposal-for-list proposal %}
		        	</li>
		        {% endfor %}
		        </ul>
		        <a href="{% url user-proposals member.slug %}">See all proposals</a>
	        </div>
	    {% else %}
	        <p>{{member.display_name}} made no proposals.</p>
	    {% endif %}
	
		{% if comment_list %}
			<div class="profile-comment-list">
		    	<h1>{{member.display_name}}'s comments</h1>
		    	{% for comment in comment_list %}
		        <table>
		        	<tr>
		        		<th>{{comment.upvote_score}}</th>
		        		<td>{{comment.proposal.title}}</td>
		        	</tr>
		        </table>
		        {% endfor %}
		        <a href="{% url user-comments member.slug %}">See all comments</a>
	        </div>
	    {% else %}
	    {% endif %}
	
		{% if tag_list %}
	    	<div class="profile-tag-list">
		    	<h1>{{member.display_name}}'s tags</h1>
		        {% for tag in tag_list %}
		        	<span>{{tag.1}} &#x2a2f; {% usemacro tag-small tag.0 %}{% usemacro comma %}</span>
		        {% endfor %}
		        <a href="{% url user-tags member.slug %}">See all tags</a>
	        </div>
	    {% else %}
	    {% endif %}
	    
	
		{% if vote_list %}
	    	<div class="profile-vote-list">
		    	<h1>{{member.display_name}}'s votes</h1>
		        {% for vote in vote_list %}
		        	<table>
			        	<tr>
			        		<th>{{vote.value}}</th>
			        		<td>{{vote.numvotes}} votes</td>
			        		<td>{{vote.proposal.title}}</td>
			        	</tr>
			        </table>
		        {% endfor %}
		        <a href="{% url user-votes member.slug %}">See all votes</a>
	        </div>
	    {% else %}
	    {% endif %}
	
	    
		{% if proxy_vote_list %}
			<div class="profile-proxy-vote-list">
		    	<h1>{{member.display_name}}'s votes through proxies</h1>
		        {% for proxy in proxy_vote_list %}
		        	<table>
			        	<tr>
			        		<th>{{proxy.value}}</th>
			        		<td>{{proxy.proposal.title}}</td>
			        	</tr>
			        </table>
		        {% endfor %}
		        <a href="{% url user-proxy-votes member.slug %}">See all votes the user made through proxies</a>
	        </div>
	    {% else %}
	    {% endif %}
	{% endblock %}

{% endblock %}
